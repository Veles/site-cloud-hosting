## Быстрый запуск:
1. vagrant up
2. запустить `./prepare.sh` (/etc/hosts должен быть доступен для записи. В случае повтороного запуска скрипта  - очистить его от старых\дублирующих записей
3. Ввести пароль 'vagrant'
4. `ansible-playbook -i hosts site.yml`  установит всё  приведёт хосты в правильное состояние

## Описание проекта
 В файле Vagrantfile описаны создаваемые виртуальные машины. 
# Описание используемых машин
 * web[1-3] - содержат только apache и клиент glusterfs для использования дискового кластера. При запуске регистрируются в consul. При возникновении проблем на ноде она сообщает об этом в consul  (скрипты mem.sh и проверки консула ping.json и web.json)
 * nginx - принимает входящие соединения и проксирует их на haproxy. В следующих версия будет так же иметь клиент glustefs и отдавать статические файлы клиентам
 * haproxy - получает из consul список живых нод (используется модуль consul-haproxy) и подставляет их в список для балансировки нагрузки
 * ceph[1-3] - хосты с распределённой файловой системой glusterfs. Название осталось от старой версии, когда в качестве распределённой fs испльзовался ceph. К сожалению производительность тестовой машины не достаточно для корректной работы ceph. Машина ceph1 является мастером и именно с неё создаётся кластер. Так же на этих машинах запускаются ноды consul
 * db[1-2] - временно не используются. В планах разместить на них реплицируемую мастер-мастер базу данных
 * consul - мастер нода consul, в которую стекается инфорамция о "живых" web нодах и их состоянии.
